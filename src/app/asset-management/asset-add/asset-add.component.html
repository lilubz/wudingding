<div class="row">
  <div class="col-lg-12">
    <div class="card">
      <div class="card-header">
        <i class="fa fa-align-justify"></i> 新增资产
        <button class="btn btn-primary btn-sm mb-0 pull-right" type="button" (click)="showUploadAssetModal(uploadAssetModal)">导入</button>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-3">

          </div>
          <div class="col-md-6">
            <div class="form-group row">
              <label class="col-md-3 form-control-label">名称
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <input type="text" [(ngModel)]="addForm.assetName" name="hf-email" class="form-control" placeholder="请输入名称" maxlength="20">
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">规格
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <input type="text" [(ngModel)]="addForm.brandSpecification" name="hf-email" class="form-control" placeholder="请输入规格" maxlength="20">
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">主资产编码</label>
              <div class="col-md-9">
                <input type="text" [(ngModel)]="addForm.majorAssetSerialNumber" name="hf-email" class="form-control" placeholder="请输入主资产编码"
                  maxlength="20">
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">组织部门
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <input type="text" class="form-control" [(ngModel)]="selectedAddOrg.label" (click)="$event.stopPropagation();showAddOrgSelect=!showAddOrgSelect"
                  maxlength="0">
                <div style="position: relative" *ngIf="showAddOrgSelect" (click)="$event.stopPropagation()">
                  <div style="position: absolute;z-index: 9999;">
                    <p-tree [value]="addOrganizations" selectionMode="single" [(selection)]="selectedAddOrg" (onNodeSelect)="nodeSelect($event, 'add')"
                      styleClass="col-md-12"></p-tree>
                  </div>
                </div>
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">资产类型
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <select class="form-control" [(ngModel)]="addFormCategory" (ngModelChange)="addFormCategoryChange($event)" name="select">
                  <option value="">--请选择--</option>
                  <ng-container *ngFor="let category of categories">
                    <option [ngValue]="category">{{ category.categoryName }}</option>
                  </ng-container>
                </select>
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">使用人
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <div class="row">
                  <p-autoComplete [suggestions]="employeeSuggestions" [(ngModel)]="addFormEmployee" (completeMethod)="searchEmployee($event)"
                    (onBlur)="onBlurFromEmployeeAdd($event)" styleClass="col-md-12" [forceSelection]="false" field="employeeName"
                    (onSelect)="selectSuggestedEmployee($event,'add')" [delay]="500" [size]="20" [minLength]="1" [maxlength]="20"
                    [inputStyleClass]="'form-control'" placeholder="请输入资产使用人">
                    <ng-template let-employee pTemplate="item">
                      <div>{{ employee.employeeName }}</div>
                    </ng-template>
                  </p-autoComplete>
                </div>
                <!-- <input type="text" [(ngModel)]="addForm.employeeNumber" name="hf-email" class="form-control" placeholder="请输入使用人" maxlength="20"> -->
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">使用状态
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <select class="form-control" [(ngModel)]="addForm.useStatus" name="select">
                  <!-- <option value="">--请选择--</option> -->
                  <ng-container *ngFor="let status of statusTypes">
                    <option [value]="status.assetStatusTypeName">{{ status.assetStatusTypeName }}</option>
                  </ng-container>
                </select>
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">购买批次
                <!-- <span class="required">*</span> -->
              </label>
              <div class="col-md-9">
                <input type="text" [(ngModel)]="addForm.batchSerialNumber" name="hf-email" class="form-control" placeholder="请输入购买批次" maxlength="20">
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">存放位置
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <input type="text" [(ngModel)]="addForm.storageLocation" name="hf-email" class="form-control" placeholder="请输入存放位置" maxlength="20">
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">购买时间
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <p-calendar [monthNavigator]="true" [yearNavigator]="true" yearRange="1970:2050" [selectOtherMonths]="true" [showButtonBar]="true"
                  [(ngModel)]="addForm.purchaseTime" dateFormat="yy-mm-dd" [locale]="zh" [showIcon]="false" inputStyleClass="add-purchase-date"
                  [maxDate]="today" readonlyInput="true" placeholder="请输入购买时间"></p-calendar>
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">购买金额
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <input type="number" [(ngModel)]="addForm.purchaseAmount" name="hf-email" class="form-control" placeholder="请输入购买金额" maxlength="20">
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">折旧月数
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <input type="number" [(ngModel)]="addForm.monthOfDepreciation" name="hf-email" class="form-control" placeholder="请输入折旧月数"
                  maxlength="20">
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <div class="form-group row">
              <label class="col-md-3 form-control-label">残值率
                <span class="required">*</span>
              </label>
              <div class="col-md-9">
                <div class="input-group">
                  <input type="text" [(ngModel)]="addForm.residualRatio" name="hf-email" class="form-control" placeholder="请输入残值率" maxlength="20">
                  <span class="input-group-addon">%</span>
                </div>
                <!-- <span class="help-block">Please enter your email</span> -->
              </div>
            </div>
            <button type="button" class="btn btn-primary" (click)="addAsset()">保存</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #uploadAssetModal>
  <div class="modal-header">
    <h4 class="modal-title">资产导入</h4>
    <button type="button" class="close" (click)="uploadAssetModalRef.hide()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <p-steps [model]="uploadSteps" [(activeIndex)]="activeUploadStepIndex" [readonly]="false"></p-steps>
    <div class="col-md-12 upload-step" *ngIf="activeUploadStepIndex===0">
      <a class="btn btn-primary" href="">点击下载模板文件</a>
    </div>
    <div class="col-md-12 upload-step" *ngIf="activeUploadStepIndex===1">
      请按照模板文件格式填写数据
    </div>
    <div class="col-md-12 upload-step" *ngIf="activeUploadStepIndex===2">
      <div style="margin-bottom:20px;">请上传要导入的文件</div>
      <p-fileUpload [url]="uploadAssetUrl" [multiple]="false" invalidFileSizeMessageSummary="{0}: 文件过大," invalidFileSizeMessageDetail="最大文件尺寸是 {0}."
        invalidFileTypeMessageSummary="{0}: 不合法的文件类型," invalidFileTypeMessageDetail="允许的文件类型是: {0}." chooseLabel="选择文件" uploadLabel="上传"
        accept=".xls,.xlsx" cancelLabel="取消" maxFileSize="10000000" (onUpload)="uploadAsset($event)">
      </p-fileUpload>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-primary" (click)="uploadAssetModalRef.hide()">确认</button>
  </div>
</ng-template>
